# Amazon Data Analysis Using SQL

<div align="center">
    <img src="https://github.com/user-attachments/assets/5610fbcf-06d9-4dc3-b538-9cd45136cc56" alt="Amazon Logo" height="200" width="400">
</div>

## Overview
This project is a comprehensive analysis of an Amazon-like e-commerce platform using SQL. The dataset simulates real-world data, capturing the complexities of e-commerce operations, including orders, products, customers, payments, shipping, inventory, and more. Through advanced SQL queries, the project derives actionable business insights and solves critical operational challenges.

---

## Key Business Problems Solved

1. **[Top-Selling Products and Categories](#top-selling-products-and-categories)**: Identify the top 10 products and categories based on total sales and revenue.  
2. **[Revenue Trends by Category](#revenue-trends-by-category)**: Analyze revenue trends across categories to find the most profitable ones.  
3. **[Customer Lifetime Value (CLV) Calculation](#customer-lifetime-value-clv-calculation)**: Compute total customer spending to highlight high-value clients.  
4. **[Average Order Value Analysis](#average-order-value-analysis)**: Evaluate the average order value to understand customer purchasing behavior.  
5. **[Monthly Sales Trends](#monthly-sales-trends)**: Monitor monthly sales trends to identify peak and low-performing periods.  
6. **[Customers Without Purchases](#customers-without-purchases)**: Highlight customers who have never made a purchase.  
7. **[Best-Selling Categories by State](#best-selling-categories-by-state)**: Determine the top categories by revenue within each state.  
8. **[Inventory Stock Alerts](#inventory-stock-alerts)**: Detect critically low stock levels for timely restocking.  
9. **[Shipping Delays Analysis](#shipping-delays-analysis)**: Evaluate shipping delays to optimize delivery processes.  
10. **[Payment Success and Failure Rates](#payment-success-and-failure-rates)**: Analyze payment transaction success and failure rates.  
11. **[Top-Performing Sellers](#top-performing-sellers)**: Rank sellers based on revenue contributions to prioritize partnerships.  
12. **[Product Margin Analysis](#product-margin-analysis)**: Evaluate product margins to identify the most profitable items.  
13. **[Most Returned Products](#most-returned-products)**: Highlight products with high return rates for quality improvement.  
14. **[Pending Shipments](#pending-shipments)**: Identify orders with completed payments but pending shipments.  
15. **[Inactive Sellers](#inactive-sellers)**: Flag sellers with no sales in the past six months.  
16. **[Categorizing Customers as Returning or New](#categorizing-customers-as-returning-or-new)**: Classify customers based on purchase history.  
17. **[Cross-Selling Opportunities](#cross-selling-opportunities)**: Identify frequently bought-together products to enhance cross-selling strategies.  
18. **[Top Customers by State](#top-customers-by-state)**: Determine the top customers within each state by order count.  
19. **[Revenue by Shipping Provider](#revenue-by-shipping-provider)**: Analyze the revenue generated by different shipping providers.  
20. **[Products with Revenue Decline](#products-with-revenue-decline)**: Identify products experiencing significant revenue declines over time.

---

## Objectives
- Perform detailed data analysis on an e-commerce dataset.
- Use SQL queries to solve real-world business problems.
- Improve proficiency in advanced SQL techniques like CTEs, window functions, and joins.
- Develop insights for revenue optimization, operational efficiency, and customer satisfaction.

---

## ER Diagram
![ER-diagram](https://github.com/user-attachments/assets/7f43e8d8-7e61-4023-8357-6adfd8d55ad2)

---

## Tech Stack Used
- **Database**: MySQL
- **Development Tool**: MySQL Workbench
- **Other Tools**: GitHub for version control

---

## Dataset Overview
The dataset contains approximately **25,000 records** spread across nine tables. Below is a detailed breakdown of the dataset structure:

### Tables and Attributes
1. **category**  
   - `category_id`: Unique identifier for categories.  
   - `category_name`: Name of the category.

2. **customer**  
   - `customer_id`: Unique identifier for customers.  
   - `first_name`, `last_name`: Customer names.  
   - `state`: Customer's state.  
   - `address`: Customer address.

3. **seller**  
   - `seller_id`: Unique identifier for sellers.  
   - `seller_name`: Name of the seller.  
   - `country`: Seller's country.

4. **product**  
   - `product_id`: Unique identifier for products.  
   - `product_name`: Name of the product.  
   - `price`, `cogs`: Price and cost of goods sold.  
   - `category_id`: Foreign key referencing `category`.

5. **orders**  
   - `order_id`: Unique identifier for orders.  
   - `order_date`: Date of the order.  
   - `customer_id`: Foreign key referencing `customer`.  
   - `seller_id`: Foreign key referencing `seller`.  
   - `order_status`: Status of the order (e.g., Delivered, Returned).

6. **order_item**  
   - `order_item_id`: Unique identifier for each item in an order.  
   - `order_id`: Foreign key referencing `orders`.  
   - `product_id`: Foreign key referencing `product`.  
   - `quantity`: Quantity of the product ordered.  
   - `price`: Price per unit of the product.

7. **payment**  
   - `payment_id`: Unique identifier for payments.  
   - `order_id`: Foreign key referencing `orders`.  
   - `payment_status`: Status of the payment (e.g., Success, Refunded).  
   - `payment_date`: Date of the payment.

8. **shipping**  
   - `shipping_id`: Unique identifier for shipping records.  
   - `order_id`: Foreign key referencing `orders`.  
   - `shipping_date`: Date of shipping.  
   - `return_date`: Date of return (if applicable).  
   - `shipping_provider`: Shipping provider name.  
   - `shipping_status`: Status of the shipping.

9. **inventory**  
   - `inventory_id`: Unique identifier for inventory records.  
   - `product_id`: Foreign key referencing `product`.  
   - `warehouse_id`: Warehouse identifier.  
   - `stock`: Stock quantity.  
   - `last_stock_date`: Date of the last stock update.

---

## List of Business Problems and Solutions

### Top-Selling Products and Categories
```sql
SELECT
    p.product_name,
    SUM(oi.quantity) AS total_quantity_sold,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM order_item oi
JOIN product p ON oi.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_revenue DESC
LIMIT 10;
```

### Revenue Trends by Category
```sql
SELECT
    c.category_name,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM order_item oi
JOIN product p ON oi.product_id = p.product_id
JOIN category c ON p.category_id = c.category_id
GROUP BY c.category_name
ORDER BY total_revenue DESC;
```

### Customer Lifetime Value (CLV) Calculation
```sql
SELECT
    c.customer_id,
    c.first_name,
    c.last_name,
    SUM(oi.quantity * oi.price) AS lifetime_value
FROM customer c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_item oi ON o.order_id = oi.order_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY lifetime_value DESC;
```

### Average Order Value Analysis
```sql
SELECT
    o.order_id,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM orders o
JOIN order_item oi ON o.order_id = oi.order_id
GROUP BY o.order_id;
```

### Monthly Sales Trends
```sql
SELECT
    DATE_FORMAT(o.order_date, '%Y-%m') AS month,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM orders o
JOIN order_item oi ON o.order_id = oi.order_id
GROUP BY month
ORDER BY month;
```

### Customers Without Purchases
```sql
SELECT
    c.customer_id,
    c.first_name,
    c.last_name
FROM customer c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.customer_id IS NULL;
```

### Best-Selling Categories by State
```sql
SELECT
    c.state,
    cat.category_name,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM customer c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_item oi ON o.order_id = oi.order_id
JOIN product p ON oi.product_id = p.product_id
JOIN category cat ON p.category_id = cat.category_id
GROUP BY c.state, cat.category_name
ORDER BY c.state, total_revenue DESC;
```

### Inventory Stock Alerts
```sql
SELECT
    p.product_name,
    i.stock
FROM inventory i
JOIN product p ON i.product_id = p.product_id
WHERE i.stock < 10;
```

### Shipping Delays Analysis
```sql
SELECT
    o.order_id,
    DATEDIFF(s.shipping_date, o.order_date) AS shipping_delay
FROM orders o
JOIN shipping s ON o.order_id = s.order_id
WHERE DATEDIFF(s.shipping_date, o.order_date) > 5;
```

### Payment Success and Failure Rates
```sql
SELECT
    payment_status,
    COUNT(*) AS count
FROM payment
GROUP BY payment_status;
```

### Top-Performing Sellers
```sql
SELECT
    s.seller_name,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM seller s
JOIN orders o ON s.seller_id = o.seller_id
JOIN order_item oi ON o.order_id = oi.order_id
GROUP BY s.seller_name
ORDER BY total_revenue DESC;
```

### Product Margin Analysis
```sql
SELECT
    p.product_name,
    (p.price - p.cogs) AS margin
FROM product p
ORDER BY margin DESC;
```

### Most Returned Products
```sql
SELECT
    p.product_name,
    COUNT(*) AS return_count
FROM shipping s
JOIN order_item oi ON s.order_id = oi.order_id
JOIN product p ON oi.product_id = p.product_id
WHERE s.return_date IS NOT NULL
GROUP BY p.product_name
ORDER BY return_count DESC;
```

### Pending Shipments
```sql
SELECT
    o.order_id,
    o.order_date
FROM orders o
LEFT JOIN shipping s ON o.order_id = s.order_id
WHERE s.shipping_id IS NULL;
```

### Inactive Sellers
```sql
SELECT
    s.seller_name,
    MAX(o.order_date) AS last_order_date
FROM seller s
LEFT JOIN orders o ON s.seller_id = o.seller_id
GROUP BY s.seller_name
HAVING last_order_date < DATE_SUB(CURDATE(), INTERVAL 6 MONTH);
```

### Categorizing Customers as Returning or New
```sql
SELECT
    c.customer_id,
    c.first_name,
    c.last_name,
    CASE
        WHEN COUNT(o.order_id) > 1 THEN 'Returning'
        ELSE 'New'
    END AS customer_type
FROM customer c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id;
```

### Cross-Selling Opportunities
```sql
SELECT
    p1.product_name AS product,
    p2.product_name AS frequently_bought_together
FROM order_item oi1
JOIN order_item oi2 ON oi1.order_id = oi2.order_id AND oi1.product_id != oi2.product_id
JOIN product p1 ON oi1.product_id = p1.product_id
JOIN product p2 ON oi2.product_id = p2.product_id
GROUP BY p1.product_name, p2.product_name
ORDER BY COUNT(*) DESC
LIMIT 10;
```

### Top Customers by State
```sql
SELECT
    c.state,
    c.first_name,
    c.last_name,
    COUNT(o.order_id) AS total_orders
FROM customer c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.state, c.customer_id
ORDER BY c.state, total_orders DESC;
```

### Revenue by Shipping Provider
```sql
SELECT
    s.shipping_provider,
    SUM(oi.quantity * oi.price) AS total_revenue
FROM shipping s
JOIN orders o ON s.order_id = o.order_id
JOIN order_item oi ON o.order_id = oi.order_id
GROUP BY s.shipping_provider
ORDER BY total_revenue DESC;
```

### Products with Revenue Decline
```sql
WITH revenue_trends AS (
    SELECT
        p.product_name,
        DATE_FORMAT(o.order_date, '%Y-%m') AS month,
        SUM(oi.quantity * oi.price) AS monthly_revenue
    FROM order_item oi
    JOIN orders o ON oi.order_id = o.order_id
    JOIN product p ON oi.product_id = p.product_id
    GROUP BY p.product_name, month
)
SELECT
    product_name,
    monthly_revenue
FROM revenue_trends
WHERE monthly_revenue < LAG(monthly_revenue) OVER (PARTITION BY product_name ORDER BY month);
```

---

## Future Business Problems to Solve
- Predictive analysis for sales trends.
- Real-time inventory updates with trigger-based SQL functions.
- Advanced customer segmentation and targeting.
- Sentiment analysis using customer feedback data (if available).
- Supply chain optimization for better shipping efficiency.

---

## Conclusion
This project demonstrates the power of SQL in solving complex business problems for an e-commerce platform. By simulating a real-world dataset, it showcases advanced querying techniques and offers actionable insights into operations, sales, and customer behavior.

Feel free to explore the repository and contribute by suggesting new problems or enhancements. Happy analyzing!

